<head>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
</head>
<div class="back">
    <div class="main">
        <div class="background-img" th:style="'background-image: url(' + ${videojuego.imagenUrl} + ')'"></div>
        <div class="juego">
            <div class="info-game">
                <div class="lado-izquierdo">
                    <p class="titulo-juego" th:text="${videojuego.nombre}">Nombre del juego</p>
                    <p class="descripcion-juego" th:text="${videojuego.descripcion}">Descripción</p>
                    <div class="plataformas-generos-container">
                        <p class="titulo">Plataformas</p>
                        <p>
                            <span th:each="plataforma, iterStat : ${videojuego.plataformas}">
                                <span class="plataforma-generos-inline" th:text="${plataforma.nombre}"></span>
                                <span th:if="${!iterStat.last}">, </span>
                            </span>
                        </p>
                    </div>
                    <div class="plataformas-generos-container">
                        <p class="titulo">Géneros</p>
                        <p>
                            <span th:each="genero, iterStat : ${videojuego.generos}">
                                <span class="plataforma-generos-inline" th:text="${genero.nombre}"></span>
                                <span th:if="${!iterStat.last}">, </span>
                            </span>
                        </p>
                    </div>
                    <div class="fecha-creadores">
                        <p class="titulo-fecha">Fecha de Lanzamiento</p>
                        <p class="fecha-juego" th:text="${videojuego.fechaLanzamiento}">Fecha</p>
                    </div>
                    <div class="fecha-creadores">
                        <p class="titulo">Creadores</p>
                        <p class="creadores-juego" th:text="${videojuego.creadores}">Creadores</p>
                    </div>
                </div>
                <div class="separador-container">
                    <div class="separador"></div>
                </div>
                <div class="lado-derecho">
                    <div class="puntuacion">
                        <p class="puntuacion-text">Puntuación</p>
                        <div class="puntuacion-num" th:classappend="' ' + ${videojuego.colorPorPuntuacion}">
                            <p class="puntuacionMedia" th:text="${videojuego.puntuacionMedia}"></p>
                        </div>
                    </div>
                    <div class="puntuacion-usuario">
                        <div class="puntuacion-info">
                            <p class="puntuacion-text">Mi Puntuación</p>
                            <div class="puntuacion-usuario-container" id="puntuacion-usuario-container">
                                <p id="ratingValue">0</p>
                            </div>
                        </div>
                        <div class="rating-container" id="myRating">
                            <div class="rating-block" data-value="1"></div>
                            <div class="rating-block" data-value="2"></div>
                            <div class="rating-block" data-value="3"></div>
                            <div class="rating-block" data-value="4"></div>
                            <div class="rating-block" data-value="5"></div>
                            <div class="rating-block" data-value="6"></div>
                            <div class="rating-block" data-value="7"></div>
                            <div class="rating-block" data-value="8"></div>
                            <div class="rating-block" data-value="9"></div>
                            <div class="rating-block" data-value="10"></div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const ratingContainer = document.getElementById('myRating');
    const blocks = ratingContainer.querySelectorAll('.rating-block');
    const ratingValueText = document.getElementById('ratingValue');
    const puntuacionUsuarioContainer = document.getElementById('puntuacion-usuario-container');
    let selectedRating = 0;

    blocks.forEach(block => {
        block.addEventListener("mouseover", () => {
            const val = parseInt(block.dataset.value);
            scoreDisplay.textContent = val;
            updateBlockColors(val);
            updateTextColor(val);
        });
        block.addEventListener("mouseout", () => {
            if (selectedScore === 0) {
                resetBlockColors();
                scoreDisplay.textContent = "—";
                scoreDisplay.className = "";
            } else {
                updateBlockColors(selectedScore);
                updateTextColor(selectedScore);
                scoreDisplay.textContent = selectedScore;
            }
        });
        block.addEventListener("click", () => {
            selectedScore = parseInt(block.dataset.value);
        });
    });

    function updateText(value) {
    ratingValueText.textContent = `${value}`;

    puntuacionUsuarioContainer.classList.remove('rating-green', 'rating-orange', 'rating-red');

    if (value >= 8) puntuacionUsuarioContainer.classList.add('rating-green');
    else if (value >= 5) puntuacionUsuarioContainer.classList.add('rating-orange');
    else if (value >= 1) puntuacionUsuarioContainer.classList.add('rating-red');
}

    function updateBlockColors(value) {
        blocks.forEach(block => {
            const blockValue = parseInt(block.dataset.value);
            block.classList.remove('active', 'medium', 'low');

            if (blockValue <= value) {
                if (value >= 8) {
                    block.classList.add('active'); // verde
                } else if (value >= 5) {
                    block.classList.add('medium'); // naranja
                } else {
                    block.classList.add('low'); // rojo
                }
            }
        });
    }

    blocks.forEach(block => {
        block.addEventListener('mouseover', () => {
            const value = parseInt(block.dataset.value);
            updateBlockColors(value);
            updateText(value);
        });

        block.addEventListener('click', () => {
            selectedRating = parseInt(block.dataset.value);
        });

        block.addEventListener('mouseout', () => {
            updateBlockColors(selectedRating);
            updateText(selectedRating || 0);
        });
    });
</script>

<link rel="stylesheet" href="/css/videojuego/review.css">